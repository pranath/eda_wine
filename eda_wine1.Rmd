An EDA of White Wine Data by Pranath Fernando
========================================================

## Introduction
```{r echo=FALSE, message=FALSE, warning=FALSE, packages}

# Set default knitr options for messages & figure sizes
knitr::opts_chunk$set(fig.width=9,fig.height=5,fig.path='Figs/',
                      fig.align='center',tidy=TRUE,
                      echo=TRUE,warning=FALSE,message=FALSE)
```

In this exploration I will be examining a data set of white wine data to try to determine which chemical properties of wine may be useful in helping to predict it's quality.

More info on this data set can be found here:

https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityInfo.txt

Some research into the literature regarding chemical factors that can effect wine quality such as:

- https://www.researchgate.net/publication/276424645_Prediction_of_Wine_Sensorial_Quality_by_Routinely_Measured_Chemical_Properties
- https://www.hindawi.com/journals/tswj/2012/249041/
- https://naramatawine.files.wordpress.com/2015/03/winemaking-uof-c-davis.pdf

These suggest that the following chemical factors may play a role in determining wine quality:

- Sulphur dioxide
- ph
- Density
- Alcohol
- Non-volatile acids
- Total acids

These chemical qualities will guide the primary features of interest in the given data set for this exploration.

The dataset consists of 4898 observations of 13 variables which are:

- **fixed.acidity**
- **volatile.acidity**
- **citric.acid**
- residual.sugar
- chlorides 
- **free.sulfur.dioxide**
- **total.sulfur.dioxide**
- **density**
- **pH**
- sulphates
- **alcohol**
- **quality**

Variables to be explored highlighted in bold.

## Univariate Plots

```{r Univariate_Plots1}

# Load initial libraries
#install.packages('ggplot2')
library(ggplot2)
#install.packages('GGally')
library(GGally)

# Set seed so results are reproducable
set.seed(1836)

# Load the Data
setwd('/Users/pranath/DataScience/r/eda_project/')
wine <- read.csv('wineQualityWhites.csv')

# Print out data types
str(wine)
# Print out summary stats for variables
summary(wine)
# Check for NA's
unique (unlist (lapply (wine, function (x) which (is.na (x)))))

```

Our dataset of white wine quality data has 13 variables with 4898 rows/observations (and no NA values)

```{r Univariate_Plots2}

# Show boxplot of wine quality values
qplot(y = quality, data = wine, geom = 'boxplot') +
  coord_cartesian() +
  theme(text=element_text(family="Garamond", size=14))
# Show summary stats of wine quality values
summary(wine$quality)

```

Wine quality scores are discrete integer values, ranging from 3 to 9. The distribution of these values seems approximately normal and fairly even around the center.

Most wines wines (IQR) have qualities that range between 5 and 6, so quite a narrow range in the mid range (ie near the median of 6) which also implies that very few wines get an exceptionally low or high score for quality.

The box plot also illustrates that the mean & median (2nd qartile) are both almost the same as the 3rd Quartile. This might be explained when we consider in the histogram around 2250 (nearly half) of wines have a quality of 6 alone.

Focussing on the bulk of the distribution...

```{r Univariate_Plots2a}

# Show boxplot of wine quality values - focussed on IQR
qplot(y = quality, data = wine, geom = 'boxplot') +
  coord_cartesian(ylim =  c(4.85, 6.15)) 

```

This also shows more clearly how most wines have a quality less than 6, and many of these wines have a quality of exactly 6 (with 2nd quartile equal to 3rd quartile).

In a way, quality is very much a categorical variable - we will create a new field later which has quality as this type of variable.

Lets look at fixed.acidity.

```{r message=FALSE, warning=FALSE, Univariate_Plots3}

# Show histogram of fixed acidity values
qplot(x = fixed.acidity, data = wine) +
  ylab('Number of wines') 
# Show summary stats of fixed acidity values
summary(wine$fixed.acidity)

```


Fixed acidity is 'most acids involved with wine or fixed or nonvolatile (do not evaporate readily)'. 

We know the values range between 3.8-14.2 (from our summary)  and most wines (IQR) have a value between 6.3-7.3.

Lets restrict the axis to get a closer look at the bulk of the values distribution of these values and adjust the binwidth to see the values at a more detailed level.

```{r message=FALSE, warning=FALSE, Univariate_Plots3a}

# Show histogram of fixed acidity values (with adjusted bin width)
qplot(x = fixed.acidity, data = wine, binwidth=0.01) +
  ylab('Number of wines') +
  xlim(4,10)

```

The distribution for the bulk of the values (IQR) for fixed acidity does look relatively normal, even at a more granular level.

Looking at a boxplot for the whole distribution...

```{r message=FALSE, warning=FALSE, Univariate_Plots3b}

# Show boxplot of fixed acidity values
qplot(y = fixed.acidity, data = wine, geom = 'boxplot') +
  coord_cartesian() 

```

This highlights that for fixed acidity while the bulk of the distribution is balanced/symetrical around the IQR, there are far more extreme outliers at the higher end of the distribution than at the lower end. Also, we can further see that the bulk of the distribution is concerntrated in a very narrow range fo values (IQR).

```{r  message=FALSE, warning=FALSE, Univariate_Plots4}

# Show histogram of volatile acidity values
qplot(x = volatile.acidity, data = wine) +
  ylab('Number of wines')
# Show summary stats of volatile acidity values
summary(wine$volatile.acidity)

```

Volatile acidity is 'the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste'.

The values for Volatile acidity are approximately normally distributed, with a slight right skew, and certainly more of a skew than fixed acidity (a greater spread of values).

Lets focus in on the bulk of the distribution and adjust bin width.

```{r message=FALSE, warning=FALSE, Univariate_Plots4a}

# Show histogram of volatile acidity values (focussed on bulk)
qplot(x = volatile.acidity, data = wine, binwidth=0.01) +
  ylab('Number of wines') +
  xlim(0,0.6)

```

We can see the slight right skew to the disribution, and most wines (IQR) have values for this variable are between 0.2 and 0.4

```{r message=FALSE, warning=FALSE, Univariate_Plots4b}

# Show boxplot of volatile acidity values
qplot(y = volatile.acidity, data = wine, geom = 'boxplot') +
  coord_cartesian(ylim =  c(0, 1)) 

```

The box plot of Volatile acidity really illustrates how skewed its distribution is by the top end outliers, despite the fact that the main bulk (IQR) of the distribution is fairly even and symmetrical. 

Lets examine a log transform of this distribution...

```{r message=FALSE, warning=FALSE, Univariate_Plots4c}

# Show histogram of volatile acidity values - using log10 scale
qplot(x = volatile.acidity, data = wine) +
  ylab('Number of wines') +
  scale_x_log10()

```

The log transform of volatile acidity does make it appear more normally distributed, much like quality - therefore there may well be a relationship.

```{r message=FALSE, warning=FALSE, Univariate_Plots5}

# Show histogram of citric acid values
qplot(x = citric.acid, data = wine) +
  ylab('Number of wines') 

# Show boxplot of citric acid values
qplot(y = citric.acid, data = wine, geom = 'boxplot') +
  coord_cartesian(ylim =  c(0, 1.66)) 

# Show summary stats of citric acid values
summary(wine$citric.acid)

```


Citric acid is 'found in small quantities, citric acid can add 'freshness' and flavor to wines'. 

The values for this continuous variable do have a slight right skew (as can be seen in the box plot), with a particularly narrow band of values (and most likely low std dev).

It should also be noted how highly concerntrated the bulk of the distribution (IQR) is around a narrow set of values. This might be an indication that a narrow set of values for citric acid may well effect quality in a significant way.


```{r message=FALSE, warning=FALSE, Univariate_Plots8}

# Show histogram of free sulfur dioxide values
qplot(x = free.sulfur.dioxide, data = wine) +
  ylab('Number of wines')

# Show boxplot of free sulfur dioxide values
qplot(y = free.sulfur.dioxide, data = wine, geom = 'boxplot') +
  coord_cartesian() 

# Show summary stats of free sulfur dioxide values
summary(wine$free.sulfur.dioxide)

```

Free sulfur dioxide is 'the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine'. 

This variable has discrete integer values. Most wines (IQR) have a value between 23 and 46, with some exterme outliers at the upper end.

Again the bulk of these values is highlighy concerntrated in a small range fo values (IQR), and is illustrated by the boxplot.

Looking at the bulk of the distribution more closely...

```{r message=FALSE, warning=FALSE, Univariate_Plots8a}

# Show histogram of free sulfur dioxide values - focussed on bulk of distribution
qplot(x = free.sulfur.dioxide, data = wine, binwidth=1) +
  ylab('Number of wines') +
  xlim(20,50)

```

We can see that the distribution of the bulk of these values for Free sulfur dioxide is relatively even across these wines.

```{r message=FALSE, warning=FALSE, Univariate_Plots9}

# Show histogram of total sulfur dioxide values
qplot(x = total.sulfur.dioxide, data = wine) +
  ylab('Number of wines')
# Show boxplot of total sulfur dioxide values
qplot(y = total.sulfur.dioxide, data = wine, geom = 'boxplot') +
  coord_cartesian() 
# Show summary stats of total sulfur dioxide values
summary(wine$total.sulfur.dioxide)

```

Total sulfur dioxide is 'the amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine'.

This may well be correlated with the previous variable Free sulfur dioxide.

Again with this distribution, there are extreme outliers at the top end - and most wines have values between 108-167 (IQR). This is also a discrete integer value.

We can also see there are not as many extereme top end outliers as we had with free sulfur dioxide.

Fousssing on the bulk of the distribution....

```{r message=FALSE, warning=FALSE, Univariate_Plots9a}

# Show histogram of total sulfur dioxide values - focussed on bulk of distribution
qplot(x = total.sulfur.dioxide, data = wine, binwidth=1) +
  ylab('Number of wines') +
  xlim(100,170)

```

Similar to Free sulfur dioxide, we can see that the bulk of the values for Total sulfur dioxide are also fairly evenly distributed.

```{r message=FALSE, warning=FALSE, Univariate_Plots10}

# Show histogram of density values
qplot(x = density, data = wine) +
  ylab('Number of wines')
# Show boxplot of density values
qplot(y = density, data = wine, geom = 'boxplot') +
  coord_cartesian() 
# Show summary stats of density values
summary(wine$density)

```

Wine density is 'the density of water is close to that of water depending on the percent alcohol and sugar content'.

This immediately suggests this variable may have a relationship to other variables such as alcohol.

This variable is a continous variable.

The most wines (IQR) have values between 0.9917 and 0.9961 - a very narrow range of values! However with some relatively exterme outliers at the top end.

Lets focus in on the bulk of these values

```{r message=FALSE, warning=FALSE, Univariate_Plots10a}

# Show histogram of density values - focussed on bulk of distribution
qplot(x = density, data = wine, binwidth=0.0010) +
  ylab('Number of wines') +
  xlim(0.9900,0.9980)

```

So for the main bulk of the values for density, there is a slight right skew.

```{r message=FALSE, warning=FALSE, Univariate_Plots11}

# Show histogram of pH values
qplot(x = pH, data = wine) +
  ylab('Number of wines')
# Show boxplot of pH values
qplot(y = pH, data = wine, geom = 'boxplot') +
  coord_cartesian() 
# Show summary stats of pH values
summary(wine$pH)

```

So pH is 'describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale'.

This immediately suggests there may be a relationship between this variable and any of the acidity variables.

For this continuous variable, the main bulk of the values (IQR) is between 3.09-3.28. The distribution of these values and the outliers seems more symmetrical both within the IQR and at the extremes.

Focussing in on the bulk of the distribution...

```{r message=FALSE, warning=FALSE, Univariate_Plots11a}

# Show histogram of pH values - focussed on bulk of distribution
qplot(x = pH, data = wine, binwidth=0.03) +
  ylab('Number of wines') +
  xlim(3.0,3.3)

```

For the bulk of the pH values, there seems to be an slight normal curve.


```{r message=FALSE, warning=FALSE, Univariate_Plots13}

# Show histogram of alcohol values
qplot(x = alcohol, data = wine) +
  ylab('Number of wines') 

# Show boxplot of alcohol values
qplot(y = alcohol, data = wine, geom = 'boxplot') +
  coord_cartesian() 

# Show summary stats of alcohol values
summary(wine$alcohol)

```

Alcohol is 'the percent alcohol content of the wine'.

The values for this continous variable are quite widely distributed, with a slight right skew. The bulk of the values (IQR) are between 9.5-11.4. The box plot further illustrates how few outliers there are here (compared to the other distributions). Could this indicate a particular 'sweet spot' for the right amount of alcohol that makes a wine good quality?

Focussing in on the bulk of these values...

```{r message=FALSE, warning=FALSE, Univariate_Plots13a}

# Show histogram of alcohol values - focussed on bulk of distribution
qplot(x = alcohol, data = wine, binwidth=0.2) +
  ylab('Number of wines') +
  xlim(9.4,11.5)

```

We can see that these values for the bulk of alcohol are fairly evenly distributed.

Looking at a log transformation of the whole distribution....

```{r message=FALSE, warning=FALSE, Univariate_Plots13b}

# Show histogram of alcohol values - transformed by log10 scale
qplot(x = alcohol, data = wine) +
  ylab('Number of wines') +
  scale_x_log10()

```

This does not appear to have transformed the data in any significant way.

## Univariate Analysis

### Dataset structure

Our dataset of white wine quality data has 4898 rows/observations, with 13 features/variables: fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide, density, pH, sulphates, alcohol & quality.

The following variables are numeric & continuous:

fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, density, pH, sulphates

The following variablea are numeric & discrete:

total.sulfur.dioxide, free.sulfur.dioxide, quality

Other observations:

- Most wines have a quality between 5-6, with almost half of all wines having a quality of 6
- Quality is really a categorial variable
- Many variables have outliers at the top end (e.g. volatile.acidity)
- Many variables have a bulk of their values in a narrow concertraion (e.g. citric acid)
- Some variables have a slight right skew in the bulk of their distributions (density)
- Some variables have a relatively even distribution in the bulk of their distributions (free sulphur dioxide, total sulphur dioxide, alchohol)
- Many of these distributions have their bulk (IQR) as a relatively symmetrical/normal shape similar to that of quality, this may indicate that these are useful predictors of quality.

### Main features of interest

My main feature of interest is quality, and I am interested in seeing what other variables/features are useful for predicting wine quality that were indicated as promising by other research cited earlier i.e. 

- **fixed.acidity**
- **volatile.acidity**
- **citric.acid**
- **free.sulfur.dioxide**
- **total.sulfur.dioxide**
- **density**
- **pH**
- **alcohol**
- **quality**

At this stage, I still have an open mind as to what features may be useful for predicting wine quality.

I created the following new variables from a log 10 transform of:

- **volatile.acidity**
- **alcohol**

The log transformed volatile acidity turned a skewed distribution into a more normal one, but the log transformation of alcohol did not indicate any significant features from the original distribution.

I often zoomed in on the core of distributions. especially in cases where the data was squewed or had extereme outliers. I also adjusted bin width to be mor granualar when zooming in on an area of intrerest.
